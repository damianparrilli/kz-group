---
const { t } = Astro.props;
---

<section id="contacto" class="py-36 bg-oscuro min-h-[100dvh]">
  <div
    class="contenedor flex flex-col justify-center items-center gap-12 w-full"
  >
    <h2 class="text-claro text-3xl font-bold">{t.title}</h2>
    <div
      class="flex flex-col lg:flex-row w-full gap-24 md:gap-8 max-w-[600px] lg:max-w-none"
    >
      <div class="flex flex-col gap-4 w-full">
        <h3 class="text-claro text-xl font-medium">{t.redes}</h3>
        <div class="flex flex-col w-full gap-4 text-sm sm:text-base">
          <div class="flex gap-4 w-full h-full flex-col min-[450px]:flex-row">
            <div
              class="rounded-lg px-4 py-10 border-[0.5px] border-claro flex flex-col gap-2 justify-center items-center w-full"
            >
              <svg
                class="w-9 h-auto"
                viewBox="0 0 38 28"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M34.7894 0C36.5352 0 37.9528 1.38418 37.9528 3.09307V24.739C37.9528 26.446 36.5371 27.832 34.7894 27.832H3.16336C1.41754 27.832 0 26.4479 0 24.739V3.09307C0 1.38603 1.41564 0 3.16336 0H34.7894ZM13.6023 16.3801L4.28487 25.3828H33.3662L24.1493 16.4729L18.9764 19.9741L13.6023 16.3801ZM35.372 8.89141L26.2709 15.0441L35.372 23.8316V8.89141ZM2.58269 9.00459V23.544L11.475 14.9514L2.58269 9.00459ZM34.759 2.45107H3.22219C3.04902 2.44313 2.8793 2.50022 2.74778 2.61064C2.68934 2.66182 2.64422 2.72588 2.61617 2.79752C2.58811 2.86916 2.57794 2.94631 2.58648 3.02256V6.02842L18.9764 16.9887L35.3796 5.9208V3.15244C35.3815 2.90381 35.3226 2.72383 35.205 2.61064C35.1466 2.55506 35.0768 2.51213 35.0003 2.48464C34.9238 2.45715 34.8423 2.44571 34.7609 2.45107H34.759Z"
                  fill="#EB9719"></path>
              </svg>

              <h4 class="text-base sm:text-lg font-medium">E-mail</h4>
              <a
                href="mailto:info@kzgroup.com.ar"
                class="text-center underline hover:text-hoverClaro transition-all duration-300 ease-in-out"
              >
                info@kzgroup.com.ar
              </a>
            </div>
            <div
              class="rounded-lg px-4 py-10 border-[0.5px] border-claro flex flex-col gap-2 justify-center items-center w-full"
            >
              <svg
                class="w-9 h-auto"
                viewBox="0 0 38 38"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18.8333 26.3161C20.8176 26.3161 22.7206 25.5278 24.1237 24.1247C25.5268 22.7216 26.3151 20.8186 26.3151 18.8343C26.3151 16.85 25.5268 14.947 24.1237 13.5439C22.7206 12.1408 20.8176 11.3525 18.8333 11.3525C16.849 11.3525 14.946 12.1408 13.5429 13.5439C12.1398 14.947 11.3516 16.85 11.3516 18.8343C11.3516 20.8186 12.1398 22.7216 13.5429 24.1247C14.946 25.5278 16.849 26.3161 18.8333 26.3161Z"
                  stroke="#EB9719"
                  stroke-width="2.79218"
                  stroke-linecap="round"
                  stroke-linejoin="round"></path>
                <path
                  d="M2 26.3158V11.3522C2 8.87185 2.98532 6.49308 4.7392 4.7392C6.49308 2.98532 8.87185 2 11.3522 2H26.3158C28.7961 2 31.1749 2.98532 32.9288 4.7392C34.6826 6.49308 35.668 8.87185 35.668 11.3522V26.3158C35.668 28.7961 34.6826 31.1749 32.9288 32.9288C31.1749 34.6826 28.7961 35.668 26.3158 35.668H11.3522C8.87185 35.668 6.49308 34.6826 4.7392 32.9288C2.98532 31.1749 2 28.7961 2 26.3158Z"
                  stroke="#EB9719"
                  stroke-width="2.79218"></path>
                <path
                  d="M29.1191 8.56509L29.1375 8.54492"
                  stroke="#EB9719"
                  stroke-width="2.79218"
                  stroke-linecap="round"
                  stroke-linejoin="round"></path>
              </svg>

              <h4 class="text-base sm:text-lg font-medium">Instagram</h4>
              <a
                href="https://www.instagram.com/kz_moldes_dispositivos/"
                target="_blank"
                class="text-center underline hover:text-hoverClaro transition-all duration-300 ease-in-out"
              >
                @kz_moldes_dispositivos
              </a>
            </div>
          </div>
          <div class="flex gap-4 w-full h-full">
            <div
              class="rounded-lg px-4 py-10 border-[0.5px] border-claro flex flex-col gap-2 justify-center items-center w-full"
            >
              <svg
                class="w-9 h-auto"
                viewBox="0 0 31 31"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M8.96257 6.45865C8.96222 7.14379 8.68972 7.80074 8.20501 8.28496C7.7203 8.76919 7.06308 9.04103 6.37794 9.04069C5.6928 9.04035 5.03585 8.76785 4.55163 8.28314C4.0674 7.79842 3.79556 7.14121 3.7959 6.45607C3.79624 5.77092 4.06874 5.11398 4.55345 4.62975C5.03816 4.14552 5.69538 3.87368 6.38052 3.87402C7.06567 3.87437 7.72261 4.14687 8.20684 4.63158C8.69106 5.11629 8.96291 5.77351 8.96257 6.45865ZM9.04007 10.9536H3.8734V27.1253H9.04007V10.9536ZM17.2034 10.9536H12.0626V27.1253H17.1517V18.6391C17.1517 13.9116 23.313 13.4724 23.313 18.6391V27.1253H28.4151V16.8824C28.4151 8.91282 19.2959 9.2099 17.1517 13.1236L17.2034 10.9536Z"
                  fill="#EB9719"></path>
              </svg>
              <h4 class="text-base sm:text-lg font-medium">LinkedIn</h4>
              <a
                href="https://www.linkedin.com/in/kz-group-iny/"
                target="_blank"
                class="text-center underline hover:text-hoverClaro transition-all duration-300 ease-in-out"
              >
                kz_group
              </a>
            </div>
          </div>
        </div>
      </div>
      <form
  id="contact-form"
  action="https://api.web3forms.com/submit"
  method="POST"
  class="flex flex-col gap-4 w-full "
>
  <input type="hidden" name="access_key" value="0c2ab805-1c47-47fc-bab5-5d000c250703" />
  <input type="hidden" name="subject" value="Nuevo mensaje desde el formulario de contacto de la página de KZ Group" />
  <input type="hidden" name="from_name" value="KZ Group" />
  <input type="checkbox" name="botcheck" class="hidden" style="display:none;" />

  <h3 class="text-claro text-xl font-medium">{t.formTitle}</h3>

  <div class="flex flex-col">
    <label for="nombre" class="sr-only">{t.formName}</label>
    <input
      type="text"
      name="nombre"
      id="nombre"
      placeholder={t.formName}
      class="w-full rounded-lg px-4 py-2 border text-oscuro bg-[#DBDBDB]"
    />
    <p class="text-red-600 text-sm mt-1 hidden" id="error-nombre"></p>
  </div>

  <label for="email" class="sr-only">E-mail</label>
  <div class="flex flex-col">
    <input
      type="email"
      name="email"
      id="email"
      placeholder="E-mail"
      class="w-full rounded-lg px-4 py-2 border text-oscuro bg-[#DBDBDB]"
    />
    <p class="text-red-600 text-sm mt-1 hidden" id="error-email"></p>
  </div>

  <label for="asunto" class="sr-only">{t.formSubject}</label>
  <div class="flex flex-col">
    <input
      type="text"
      name="asunto"
      id="asunto"
      placeholder={t.formSubject}
      class="w-full rounded-lg px-4 py-2 border text-oscuro bg-[#DBDBDB]"
    />
    <p class="text-red-600 text-sm mt-1 hidden" id="error-asunto"></p>
  </div>

  <label for="mensaje" class="sr-only">{t.formMessage}</label>
  <div class="flex flex-col">
    <textarea
      name="mensaje"
      id="mensaje"
      placeholder={t.formMessage}
      class="w-full rounded-lg px-4 py-2 border text-oscuro bg-[#DBDBDB] min-h-32 md:h-full"
    ></textarea>
    <p class="text-red-600 text-sm mt-1 hidden" id="error-mensaje"></p>
  </div>

  <button
    type="submit"
    class="w-full text-center font-medium rounded-md bg-acento text-oscuro px-7 py-3 text-lg cursor-pointer hover:bg-[#f7b046] transition-all duration-300 ease-in-out"
  >
    {t.button}
  </button>

  <p id="form-status" class="text-sm"></p>
</form>
    </div>
  </div>
</section>

<script type="module">
  const form = document.querySelector("#contact-form");
  const statusEl = document.getElementById("form-status");

  const nombre = document.getElementById("nombre");
  const email = document.getElementById("email");
  const asunto = document.getElementById("asunto");
  const mensaje = document.getElementById("mensaje");

  const errorNombre = document.getElementById("error-nombre");
  const errorEmail = document.getElementById("error-email");
  const errorAsunto = document.getElementById("error-asunto");
  const errorMensaje = document.getElementById("error-mensaje");

  const lang = document.documentElement.lang || "es";

  const translations = {
    es: {
      errors: {
        nombre: "Ingresa tu nombre.",
        email: "Ingresa tu correo.",
        emailInvalid: "Ingresa un correo válido.",
        asunto: "Ingresa el asunto.",
        mensaje: "Escribe un mensaje.",
      },
      status: {
        sending: "Enviando...",
        success: "Mensaje enviado correctamente.",
        error: "Error: ",
        connection: "Error de conexión. Intenta nuevamente.",
      },
    },
    en: {
      errors: {
        nombre: "Enter your name.",
        email: "Enter your email.",
        emailInvalid: "Enter a valid email.",
        asunto: "Enter the subject.",
        mensaje: "Write a message.",
      },
      status: {
        sending: "Sending...",
        success: "Message sent successfully.",
        error: "Error: ",
        connection: "Connection error. Please try again.",
      },
    },
  };

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    let valid = true;

    [errorNombre, errorEmail, errorAsunto, errorMensaje].forEach((el) => {
      el.textContent = "";
      el.classList.add("hidden");
    });

    if (!nombre.value.trim()) {
      errorNombre.textContent = translations[lang].errors.nombre;
      errorNombre.classList.remove("hidden");
      valid = false;
    }
    if (!email.value.trim()) {
      errorEmail.textContent = translations[lang].errors.email;
      errorEmail.classList.remove("hidden");
      valid = false;
    } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value)) {
      errorEmail.textContent = translations[lang].errors.emailInvalid;
      errorEmail.classList.remove("hidden");
      valid = false;
    }
    if (!asunto.value.trim()) {
      errorAsunto.textContent = translations[lang].errors.asunto;
      errorAsunto.classList.remove("hidden");
      valid = false;
    }
    if (!mensaje.value.trim()) {
      errorMensaje.textContent = translations[lang].errors.mensaje;
      errorMensaje.classList.remove("hidden");
      valid = false;
    }

    if (!valid) return;

    statusEl.textContent = translations[lang].status.sending;
    statusEl.className = "text-blue-600 text-sm";

    const formData = new FormData(form);

    try {
      const res = await fetch(form.action, { method: "POST", body: formData });
      const data = await res.json();

      if (res.ok && data.success) {
        statusEl.textContent = translations[lang].status.success;
        statusEl.className = "text-green-600 text-sm";
        form.reset();
      } else {
        statusEl.textContent =
          translations[lang].status.error +
          (data.message || (lang === "es" ? "No se pudo enviar." : "Could not send."));
        statusEl.className = "text-red-600 text-sm";
      }
    } catch {
      statusEl.textContent = translations[lang].status.connection;
      statusEl.className = "text-red-600 text-sm";
    }
  });
</script>
